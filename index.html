<!DOCTYPE html>
<html>
<head>
  <title>Kiểm tra thông tin</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Nhập thông tin</h1>
  <form id="loginForm">
    <label for="userid">User ID:</label>
    <input type="text" id="userid" name="userid"><br><br>
    <label for="password">Password:</label>
    <input type="password" id="password" name="password"><br><br>
    <input type="submit" value="Submit">
  </form>
  <div id="result"></div>

  <script>
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      var userId = document.getElementById('userid').value;
      var password = document.getElementById('password').value;
      
      // Gửi yêu cầu POST đến Google Apps Script
      fetch('https://script.google.com/macros/s/AKfycbx4piVyxquEa8lyP1NYszJWJiuJhAQcDRbwxVIK5cn2sBg5JPpmAPaeNsekyV3yS9oK/exec', { 
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ userid: userId, password: password })
      })
      .then(response => response.json())
      .then(data => {
        var resultDiv = document.getElementById('result');
        resultDiv.innerHTML = ''; // Xóa kết quả cũ
        if (data.status === 'success') {
          // Hiển thị thông tin người dùng
          var table = document.createElement('table');
          table.classList.add('user-table');
          var headerRow = table.insertRow();
          var headers = ["User ID", "Nama", "Shop ID", "Shop Name", "Tanggal", "Target", "Pencapaian", "Rata-rata", "Jumlah Hari", "Bonus", "Insentif", "Total"];
          headers.forEach(headerText => {
            var headerCell = headerRow.insertCell();
            headerCell.textContent = headerText;
          });

          var dataRow = table.insertRow();
          data.userData.forEach((cellData, index) => {
            if (index !== 1) { // Bỏ qua cột Password
              var cell = dataRow.insertCell();
              var value = cellData;
              if (index >= 3 && index <= 14 || index === 17) {
                value = Math.round(value).toLocaleString('en-US'); // Làm tròn và thêm dấu phân cách hàng nghìn
              } else if (index === 16) {
                value = `${(value * 100).toFixed(2)}%`; // Chuyển thành phần trăm
              }
              cell.textContent = value;
            }
          });
          resultDiv.appendChild(table);
        } else {
          resultDiv.textContent = data.message;
        }
      })
      .catch(error => {
        console.error('Lỗi:', error);
        var resultDiv = document.getElementById('result');
        resultDiv.innerHTML = ''; 
        resultDiv.textContent = "An error occurred. Please try again later.";
      });
    });
  </script>
</body>
</html>
